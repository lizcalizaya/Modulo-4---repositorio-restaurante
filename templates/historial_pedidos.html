{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Historial de pedidos</title>
  <style>
    * { box-sizing:border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: radial-gradient(circle at top left, #e3f0ff 0, #f6f7fb 40%, #f2f3f8 100%);
      color: #111827;
    }
    .app-layout {
      display: grid;
      grid-template-columns: 260px 1fr;
      min-height: 100vh;
    }
    .sidebar {
      background: #0f172a;
      color: #e5e7eb;
      display:flex;
      flex-direction:column;
      padding:20px 18px;
    }
    .sidebar-logo {
      display:flex;
      align-items:center;
      gap:10px;
      margin-bottom:26px;
    }
    .logo-circle {
      width:38px;height:38px;border-radius:50%;
      background:linear-gradient(135deg,#0ea5e9,#6366f1);
      display:flex;align-items:center;justify-content:center;
      color:#fff;font-weight:700;
    }
    .logo-text{display:flex;flex-direction:column;}
    .logo-title{font-size:15px;font-weight:700;}
    .logo-subtitle{font-size:12px;color:#9ca3af;}
    .sidebar-nav{display:flex;flex-direction:column;gap:6px;margin-bottom:auto;}
    .nav-item{
      display:flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:10px;
      text-decoration:none;font-size:14px;
      color:#e5e7eb;
      transition:background .15s,color .15s,transform .05s;
    }
    .nav-item:hover{background:rgba(148,163,184,.18);transform:translateX(1px);}
    .nav-item.active{background:linear-gradient(90deg,#3b82f6,#0ea5e9);color:#fff;}
    .nav-dot{width:8px;height:8px;border-radius:999px;background:#6b7280;}
    .nav-dot-blue{background:#bfdbfe;}
    .sidebar-footer{
      margin-top:24px;padding:10px 12px;border-radius:12px;
      background:rgba(15,23,42,.7);border:1px solid rgba(148,163,184,.25);
      font-size:12px;
    }
    .sidebar-footer-title{display:block;color:#9ca3af;}
    .sidebar-footer-text{font-weight:600;color:#e5e7eb;}

    .main-area{display:flex;flex-direction:column;min-height:100vh;}
    .topbar{
      height:68px;background:rgba(255,255,255,.9);
      backdrop-filter:blur(10px);
      border-bottom:1px solid rgba(209,213,219,.6);
      display:flex;align-items:center;justify-content:space-between;
      padding:0 24px;
    }
    .page-title{margin:0;font-size:20px;font-weight:700;}
    .page-subtitle{margin:2px 0 0 0;font-size:13px;color:#6b7280;}
    .user-chip{
      display:flex;align-items:center;gap:8px;
      padding:4px 10px;border-radius:999px;
      background:#eef2ff;border:1px solid #c7d2fe;
    }
    .user-avatar{
      width:26px;height:26px;border-radius:999px;
      background:linear-gradient(135deg,#4f46e5,#0ea5e9);
      display:flex;align-items:center;justify-content:center;
      color:#fff;font-size:13px;font-weight:700;
    }
    .user-info{display:flex;flex-direction:column;}
    .user-name{font-size:13px;font-weight:600;}
    .user-role{font-size:11px;color:#6b7280;}

    .contenedor-page{
      flex:1;
      padding:18px 24px 32px 24px;
    }
    .panel{
      max-width:1000px;
      margin:0 auto;
      background:#ffffff;
      border-radius:16px;
      box-shadow:0 10px 30px rgba(15,23,42,.08);
      padding:20px 22px;
    }
    h1{margin:0 0 6px 0;font-size:20px;}
    .subtexto{color:#6b7280;font-size:13px;margin-bottom:16px;}

    table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
    }
    th,td{
      padding:8px 6px;
      border-bottom:1px solid #e5e7eb;
      text-align:left;
    }
    th{
      color:#6b7280;
      font-weight:600;
      background:#f9fafb;
    }
    tr:last-child td{
      border-bottom:none;
    }
    .texto-secundario{
      color:#6b7280;
      font-size:13px;
    }
  </style>
</head>
<body>

<div class="app-layout">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="logo-circle">M</div>
      <div class="logo-text">
        <span class="logo-title">Modulo 4</span>
        <span class="logo-subtitle">Pedidos Cocina</span>
      </div>
    </div>

    <nav class="sidebar-nav">
      <a href="{% url 'monitor' %}" class="nav-item">
        <span class="nav-dot"></span>Monitor
      </a>
      <a href="{% url 'administrar_pedidos' %}" class="nav-item">
        <span class="nav-dot"></span>Administrar pedidos
      </a>
      <!-- ðŸ”¹ AquÃ­ historial va activo -->
      <a href="{% url 'historial_pedidos' %}" class="nav-item active">
        <span class="nav-dot nav-dot-blue"></span>Historial de pedidos
      </a>
      <a href="/admin/" class="nav-item">
        <span class="nav-dot"></span>Admin Django
      </a>
    </nav>

    <div class="sidebar-footer">
      <span class="sidebar-footer-title">Modo</span>
      <span class="sidebar-footer-text">Historial de pedidos</span>
    </div>
  </aside>

  <!-- MAIN -->
  <div class="main-area">
    <header class="topbar">
      <div>
        <h1 class="page-title">Historial de pedidos</h1>
        <p class="page-subtitle">Pedidos registrados en la jornada actual.</p>
      </div>
      <div class="user-chip">
        <div class="user-avatar">CO</div>
        <div class="user-info">
          <span class="user-name">Cocina</span>
          <span class="user-role">Historial</span>
        </div>
      </div>
    </header>

    <div class="contenedor-page">
      <div class="panel">
        <h1>Historial de pedidos de la jornada</h1>
        <p class="subtexto">
          Se muestran los pedidos con su hora de ingreso, salida y tiempo total de atenciÃ³n.
        </p>

        {% if registros %}
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Mesa</th>
                <th>Cliente</th>
                <th>Orden</th>
                <th>Hora ingreso</th>
                <th>Hora salida</th>
                <th>Tiempo total</th>
              </tr>
            </thead>
            <tbody>
            {% for r in registros %}
              <tr>
                <td>{{ r.pedido.id }}</td>
                <td>{{ r.pedido.mesa }}</td>
                <td>{{ r.pedido.cliente }}</td>
                <td>{{ r.pedido.descripcion|default:"-" }}</td>
                <td>{{ r.hora_ingreso|date:"H:i:s" }}</td>

                {% if r.hora_salida %}
                  <td>{{ r.hora_salida|date:"H:i:s" }}</td>
                  <td class="texto-secundario">
                    {{ r.hora_ingreso|timesince:r.hora_salida }}
                  </td>
                {% else %}
                  <td>â€“</td>
                  <td class="texto-secundario">En curso</td>
                {% endif %}
              </tr>
            {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="texto-secundario">AÃºn no hay pedidos registrados en la jornada de hoy.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>

</body>
</html>
